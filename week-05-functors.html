

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.1. Printing and Validating Generic Arrays &mdash; YSC2229 2021</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5.2. Best-Worst Case for Comparison-Based Sorting" href="week-04-sorting-best-worst.html" />
    <link rel="prev" title="5. Week 05: Binary Heaps and Priority Queues" href="week-05.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> YSC2229: Introductory Data Structures and Algorithms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="syllabus.html">1. Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="prerequisites.html">2. Software Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="codestyle.html">3. OCaml Style Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="week-01.html">1. Week 01: Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-02.html">2. Week 02: Working with Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-03.html">3. Week 03: Complexity of Algorithms and Order Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-04.html">4. Week 04: Divide-and-Conquer Algorithms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="week-05.html">5. Week 05: Binary Heaps and Priority Queues</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.1. Printing and Validating Generic Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-04-sorting-best-worst.html">5.2. Best-Worst Case for Comparison-Based Sorting</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-04-linear-time.html">5.3. Sorting in Linear Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-05-heaps.html">5.4. Binary Heaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-05-heapify.html">5.5. Maintaining Binary Heaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-05-heapsort.html">5.6. Heapsort</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-05-priority.html">5.7. Priority Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-05-exercises.html">5.8. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="week-06.html">6. Week 06: Abstract Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="midterm.html">7. Midterm Project: Memory Allocation and Reclamation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">YSC2229: Introductory Data Structures and Algorithms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="week-05.html">5. Week 05: Binary Heaps and Priority Queues</a> &raquo;</li>
        
      <li>5.1. Printing and Validating Generic Arrays</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="printing-and-validating-generic-arrays">
<span id="sec-array-functors"></span><h1>5.1. Printing and Validating Generic Arrays<a class="headerlink" href="#printing-and-validating-generic-arrays" title="Permalink to this headline">Â¶</a></h1>
<ul class="simple">
<li>File <code class="docutils literal notranslate"><span class="pre">ArrayUtil.ml</span></code>, search for <code class="docutils literal notranslate"><span class="pre">Week</span> <span class="pre">05</span> <span class="pre">definitions</span></code></li>
</ul>
<p>The machinery to print whole arrays, as well as their sub-arrays has proven very
useful in the previous examples. Let us now generalise it for the future use.</p>
<p>The functor <code class="docutils literal notranslate"><span class="pre">ArrayPrinter</span></code> below takes a module parameter <code class="docutils literal notranslate"><span class="pre">P</span></code> with
some type <code class="docutils literal notranslate"><span class="pre">t</span></code> and a function <code class="docutils literal notranslate"><span class="pre">pp</span></code> (short name for <em>pretty-print</em>),
which constructs a string out of a value of type <code class="docutils literal notranslate"><span class="pre">t</span></code>. The
implementation of <code class="docutils literal notranslate"><span class="pre">ArrayPrinter</span></code> then uses <code class="docutils literal notranslate"><span class="pre">pp</span></code> as a function to
define the two familiar machineries: <code class="docutils literal notranslate"><span class="pre">print_sub_array</span></code> and
<code class="docutils literal notranslate"><span class="pre">print_array</span></code>. As you recall, those two were previously defined to
work on arrays of integers only, but now they can be used for printing
arrays of any data type, for which an instance of <code class="docutils literal notranslate"><span class="pre">P</span></code> is provided:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(* A functor for printing arrays *)</span>
<span class="k">module</span> <span class="nc">ArrayPrinter</span> <span class="o">=</span> <span class="k">functor</span> <span class="o">(</span><span class="nc">P</span> <span class="o">:</span> <span class="k">sig</span>
    <span class="k">type</span> <span class="n">t</span>
    <span class="k">val</span> <span class="n">pp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
  <span class="k">end</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="k">struct</span>

    <span class="c">(* Printing machinery *)</span>
    <span class="k">let</span> <span class="n">print_sub_array</span> <span class="n">l</span> <span class="n">u</span> <span class="n">arr</span> <span class="o">=</span>
      <span class="k">assert</span> <span class="o">(</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">u</span><span class="o">);</span>
      <span class="k">assert</span> <span class="o">(</span><span class="n">u</span> <span class="o">&lt;=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">arr</span><span class="o">);</span>
      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;[| &quot;</span><span class="o">;</span>
      <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="n">l</span> <span class="k">to</span> <span class="n">u</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">do</span>
        <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;%s&quot;</span> <span class="o">(</span><span class="nn">P</span><span class="p">.</span><span class="n">pp</span> <span class="n">arr</span><span class="o">.(</span><span class="n">i</span><span class="o">));</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">u</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">then</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;; &quot;</span>
        <span class="k">else</span> <span class="bp">()</span>
      <span class="k">done</span><span class="o">;</span>
      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot; |] &quot;</span>

    <span class="k">let</span> <span class="n">print_array</span> <span class="n">arr</span> <span class="o">=</span>
      <span class="k">let</span> <span class="n">len</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">arr</span> <span class="k">in</span>
      <span class="n">print_sub_array</span> <span class="mi">0</span> <span class="n">len</span> <span class="n">arr</span>
  <span class="k">end</span>
</pre></div>
</div>
<p>Notice that the <em>module type</em> (i.e., signature) for <code class="docutils literal notranslate"><span class="pre">P</span></code> is given
in-line via the <code class="docutils literal notranslate"><span class="pre">sig</span> <span class="pre">...</span> <span class="pre">end</span></code> syntax, just to avoid the clutter with
extra definitions.</p>
<p>The following utility function to convert an array to a list function
is generic and hence is defined at the top level:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">to_list</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">array_to_list</span> <span class="n">arr</span>
</pre></div>
</div>
<p>In this chapter, we will see yet another linearithmic (i.e., working
in <span class="math notranslate nohighlight">\(O(n \log n)\)</span>) algorithm for sorting. Therefore, it will be
useful to be able to test automatically that it indeed sorts arrays.
Since we have written the specification for sorting before, what seems
like a logical next step is to makes this definition generic
(similarly to what we have achieved by defining
<a class="reference internal" href="week-04-comparison-based-sorting.html#sec-functor-sorting"><span class="std std-ref">A functor for sorting</span></a>), so it would only rely on an operation of
comparing two elements in an array:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(* Checking whether an array is sorted *)</span>
<span class="k">module</span> <span class="nc">SortChecker</span> <span class="o">=</span> <span class="k">functor</span> <span class="o">(</span><span class="nc">C</span> <span class="o">:</span> <span class="k">sig</span>
    <span class="k">type</span> <span class="n">t</span>
    <span class="k">val</span> <span class="n">comp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
  <span class="k">end</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="k">struct</span>

  <span class="k">let</span> <span class="k">rec</span> <span class="n">sorted</span> <span class="n">ls</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">ls</span> <span class="k">with</span>
    <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">true</span>
    <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span>
      <span class="nn">List</span><span class="p">.</span><span class="n">for_all</span> <span class="o">(</span><span class="k">fun</span> <span class="n">e</span> <span class="o">-&gt;</span> <span class="nn">C</span><span class="p">.</span><span class="n">comp</span> <span class="n">e</span> <span class="n">h</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="n">t</span> <span class="o">&amp;&amp;</span> <span class="n">sorted</span> <span class="n">t</span>

  <span class="k">let</span> <span class="n">sub_array_sorted</span> <span class="n">l</span> <span class="n">u</span> <span class="n">arr</span> <span class="o">=</span>
    <span class="k">let</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">subarray_to_list</span> <span class="n">l</span> <span class="n">u</span> <span class="n">arr</span> <span class="k">in</span>
    <span class="n">sorted</span> <span class="n">ls</span>

  <span class="k">let</span> <span class="n">array_sorted</span> <span class="n">arr</span> <span class="o">=</span>
    <span class="n">sub_array_sorted</span> <span class="mi">0</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">length</span>  <span class="n">arr</span><span class="o">)</span> <span class="n">arr</span>

  <span class="k">let</span> <span class="n">sorted_spec</span> <span class="n">arr1</span> <span class="n">arr2</span> <span class="o">=</span>
    <span class="n">array_sorted</span> <span class="n">arr2</span> <span class="o">&amp;&amp;</span>
    <span class="n">same_elems</span> <span class="o">(</span><span class="n">to_list</span> <span class="n">arr1</span><span class="o">)</span> <span class="o">(</span><span class="n">to_list</span> <span class="n">arr2</span><span class="o">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Finally, in the remainder of this chapter it will be so common for us
to require both a possibility to print and to compare values of a
certain data type, that we merge these two behavioural interfaces into
a single module signature, which will be later used to describe a
parameter module for various functors that take advantage of both
sorting and printing:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="k">type</span> <span class="nc">CompareAndPrint</span> <span class="o">=</span> <span class="k">sig</span>
  <span class="k">type</span> <span class="n">t</span>
  <span class="k">val</span> <span class="n">comp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
  <span class="c">(* For pretty-printing *)</span>
  <span class="k">val</span> <span class="n">pp</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
<span class="k">end</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="week-04-sorting-best-worst.html" class="btn btn-neutral float-right" title="5.2. Best-Worst Case for Comparison-Based Sorting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="week-05.html" class="btn btn-neutral" title="5. Week 05: Binary Heaps and Priority Queues" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Ilya Sergey

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "jax": ["input/TeX", "output/HTML-CSS"]})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>