

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.2. Testing OCaml Code &mdash; YSC2229 2020</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.3. Correctness of Recursive Algorithms" href="week-01-correctness.html" />
    <link rel="prev" title="3.1. Introduction" href="week-01-intro.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> YSC2229: Introductory Data Structures and Algorithms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="syllabus.html">1. Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="prerequisites.html">2. Software Prerequisites</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="week-01.html">3. Week 01: Introduction</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="week-01-intro.html">3.1. Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.2. Testing OCaml Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-01-correctness.html">3.3. Correctness of Recursive Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-01-loops.html">3.4. From Recursion to Imperative Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-01-insert-sort.html">3.5. Sorting Lists via Insertion Sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-01-exercises.html">3.6. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="week-02.html">4. Week 02: Array Sorting and Order Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-03.html">5. Complexity of Recursive Algorithms and Array Generators</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">YSC2229: Introductory Data Structures and Algorithms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="week-01.html">3. Week 01: Introduction</a> &raquo;</li>
        
      <li>3.2. Testing OCaml Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="testing-ocaml-code">
<h1>3.2. Testing OCaml Code<a class="headerlink" href="#testing-ocaml-code" title="Permalink to this headline">Â¶</a></h1>
<ul class="simple">
<li>File: <code class="docutils literal notranslate"><span class="pre">Fact.ml</span></code></li>
</ul>
<p>In the introductory course on Computer Science, you have learned that testing is an important part of the software development process, which becomes particularly critical when designing and implementing intricate data structures and algorithms.</p>
<p>In order to write tests more efficiently in quickly growing OCaml projects, the <cite>dune</cite> build-system provides a convenient way to write <em>in-line automated</em> tests immediately in your files.</p>
<p>For instance, consider the following <a class="reference external" href="https://github.com/ysc2229/library/blob/master/lib/dune">configuration file</a>, which defines dependencies of for the libraries of the second part of this course. THe following lines:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">inline_tests</span><span class="o">)</span>
<span class="o">(</span><span class="n">preprocess</span> <span class="o">(</span><span class="n">pps</span> <span class="n">ppx_inline_test</span> <span class="n">ppx_expect</span><span class="o">))</span>
</pre></div>
</div>
<p>allow one to write the tests immediately in your OCaml code (e.g., in a file <code class="docutils literal notranslate"><span class="pre">fact.ml</span></code>), so they will be checked during the compilation of the project (you can do it via <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">runtest</span></code> or simply <code class="docutils literal notranslate"><span class="pre">make</span></code>):</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">fact</span> <span class="n">n</span> <span class="o">=</span> <span class="k">if</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fact</span> <span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span>

<span class="k">let</span><span class="o">%</span><span class="n">test</span> <span class="o">_</span> <span class="o">=</span> <span class="n">fact</span> <span class="mi">5</span> <span class="o">=</span> <span class="mi">120</span>

<span class="k">let</span><span class="o">%</span><span class="n">test</span> <span class="s2">&quot;Failing test&quot;</span> <span class="o">=</span> <span class="n">fact</span> <span class="mi">5</span> <span class="o">=</span> <span class="mi">121</span>
</pre></div>
</div>
<p>The macro-construction <code class="docutils literal notranslate"><span class="pre">let%test</span> <span class="pre">...</span></code> defines a test, which will be run during the build. Now executing <cite>dune runtest</cite> on this project, we will get:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nc">File</span> <span class="s2">&quot;lib/Fact.ml&quot;</span><span class="o">,</span> <span class="n">line</span> <span class="mi">34</span><span class="o">,</span> <span class="n">characters</span> <span class="mi">0</span><span class="o">-</span><span class="mi">38</span><span class="o">:</span> <span class="nc">Failing</span> <span class="n">test</span> <span class="n">is</span> <span class="bp">false</span><span class="o">.</span>
</pre></div>
</div>
<p>That is, the first test (to which we gave no name via <code class="docutils literal notranslate"><span class="pre">_</span></code>) has successfully passed, while the second one, called <code class="docutils literal notranslate"><span class="pre">&quot;Failing</span> <span class="pre">test&quot;</span></code> has failed.</p>
<p>One can also write tests that, instead of expecting a boolean value (like the two tests above), match an output produced by the function being tested, against some expected string. For instance, the following test will fail, as the produced and the expected strings are different:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span><span class="o">%</span><span class="n">expect_test</span> <span class="s2">&quot;todo&quot;</span> <span class="o">=</span>
  <span class="n">print_endline</span> <span class="s2">&quot;Hello, world!&quot;</span><span class="o">;</span>
  <span class="o">[%</span><span class="n">expect</span><span class="o">{|</span>
    <span class="nc">Hello</span><span class="o">,</span> <span class="n">world</span><span class="o">?</span>
  <span class="o">|}]</span>
</pre></div>
</div>
<p>The result will be the following output, pointing out the discrepancy between the produced output and the expectations:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="n">file</span><span class="o">.</span><span class="n">ml</span>    <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span> <span class="mi">20</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mi">39</span><span class="o">.</span><span class="mi">000000000</span> <span class="o">+</span><span class="mi">0800</span>
<span class="o">+++</span> <span class="n">file</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">corrected</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span> <span class="mi">20</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mi">39</span><span class="o">.</span><span class="mi">000000000</span> <span class="o">+</span><span class="mi">0800</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">103</span><span class="o">,</span><span class="mi">7</span> <span class="o">+</span><span class="mi">103</span><span class="o">,</span><span class="mi">7</span> <span class="o">@@</span>
 <span class="k">let</span><span class="o">%</span><span class="n">expect_test</span> <span class="s2">&quot;todo&quot;</span> <span class="o">=</span>
   <span class="n">print_endline</span> <span class="s2">&quot;Hello, world!&quot;</span><span class="o">;</span>
   <span class="o">[%</span><span class="n">expect</span><span class="o">{|</span>
<span class="o">-</span>    <span class="nc">Hello</span><span class="o">,</span> <span class="n">world</span><span class="o">?</span>
<span class="o">+</span>    <span class="nc">Hello</span><span class="o">,</span> <span class="n">world</span><span class="o">!</span>
   <span class="o">|}]</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="week-01-correctness.html" class="btn btn-neutral float-right" title="3.3. Correctness of Recursive Algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="week-01-intro.html" class="btn btn-neutral" title="3.1. Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ilya Sergey

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "jax": ["input/TeX", "output/HTML-CSS"]})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>