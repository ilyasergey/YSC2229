

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.1. Installing OCaml Libraries and Setting up Editors &mdash; YSC2229 2021</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2.2. Installing and using Git" href="git.html" />
    <link rel="prev" title="2. Software Prerequisites" href="prerequisites.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> YSC2229: Introductory Data Structures and Algorithms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="syllabus.html">1. Course Syllabus</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="prerequisites.html">2. Software Prerequisites</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.1. Installing OCaml Libraries and Setting up Editors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#microsoft-windows-10">2.1.1. Microsoft Windows 10</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linux">2.1.2. Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macos">2.1.3. macOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting">2.1.4. Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="git.html">2.2. Installing and using Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html">2.3. Checking your setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="codestyle.html">3. OCaml Style Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="week-01.html">1. Week 01: Introduction</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">YSC2229: Introductory Data Structures and Algorithms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="prerequisites.html">2. Software Prerequisites</a> &raquo;</li>
        
      <li>2.1. Installing OCaml Libraries and Setting up Editors</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-ocaml-libraries-and-setting-up-editors">
<h1>2.1. Installing OCaml Libraries and Setting up Editors<a class="headerlink" href="#installing-ocaml-libraries-and-setting-up-editors" title="Permalink to this headline">¶</a></h1>
<p>First, we need to install all the software necessary for fully fledged OCaml
development. The instructions on how to do so are provided below. If you
followed the instructions, but something is not working as it should, check out
the Troubleshooting section at the end of this page.</p>
<div class="section" id="microsoft-windows-10">
<h2>2.1.1. Microsoft Windows 10<a class="headerlink" href="#microsoft-windows-10" title="Permalink to this headline">¶</a></h2>
<p>Unfortunately, the OCaml infrastructure is not supported well on
Windows (natively), therefore developing large multi-file projects in
it is problematic. To circumvent this issue, we will be running OCaml
and the related software using <a class="reference external" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">Windows Subsystem for Linux</a>, a
utility that allows to run a distribution of Linux within your Windows
10 system. This setup takes a large number of steps, but once you’re
done with it, you’ll have a premium support for OCaml, and also a
fully functional Linux distribution installed on your machine.</p>
<ol class="arabic simple">
<li>First, let us enable WSL and install a Linux distribution. The
detailed steps are given in <a class="reference external" href="https://solarianprogrammer.com/2017/04/15/install-wsl-windows-subsystem-for-linux/">this online tutorial</a>.
Don’t forget the password for the Linux account you’ve just
created: you will need it to install some software. At the end of
this step, you should be able to run a “bare-bone” Ubuntu Linux
terminal as an application within your Windows system. In my case, it
looks as follows.</li>
</ol>
<a class="reference internal image-reference" href="_images/ubuntu.png"><img alt="_images/ubuntu.png" class="align-center" src="_images/ubuntu.png" style="width: 820px;" /></a>
<ol class="arabic" start="2">
<li><p class="first">You can access your Windows home folder from WSL Linux via tha path
<code class="docutils literal notranslate"><span class="pre">/mnt/c/Users/YOURNAME/</span></code> where <code class="docutils literal notranslate"><span class="pre">YOURNAME</span></code> is your Windows user
name. It is convenient to make a symbolic link for it, so you could
access it quickly, for instance, calling it <code class="docutils literal notranslate"><span class="pre">home</span></code>. This is how
you create such a link:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="nc">Users</span><span class="o">/</span><span class="nc">YOURNAME</span><span class="o">/</span> <span class="n">home</span>
</pre></div>
</div>
<p>Now you can navigate to you Windows home folder via <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">~/home</span></code> and to
your Linux home folder via <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">~</span></code>.</p>
</li>
</ol>
<ol class="arabic" start="2">
<li><p class="first">Next, we need to install a graphical shell for the Linux
distribution running in WSL. <a class="reference external" href="https://solarianprogrammer.com/2017/04/16/windows-susbsystem-for-linux-xfce-4/">This article</a>
provides detailed instructions on how to do so. Here are some
comments:</p>
<ul class="simple">
<li>You don’t have to install Firefox in WSL Linux, as you can use
your Windows browser instead.</li>
<li>The required graphical XServer shell (run separately from
Windows) can be downloaded from <a class="reference external" href="https://sourceforge.net/projects/vcxsrv/">this resource</a>.</li>
<li>To run Linux with the graphical mode, you will <cite>always</cite> have to
first run the XServer, and then the Ubuntu shell, in which you
will have to type <code class="docutils literal notranslate"><span class="pre">xfce4-session</span></code>. The Ubuntu window will have
to stay running as long as you use Linux.</li>
</ul>
</li>
<li><p class="first">If the Linux image appears to be somewhat “blurred”, here’s how to fix it:</p>
<ul>
<li><p class="first">First, add the following lines at the end of the file
<code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> in your Linux home folder:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="nc">GDK_SCALE</span><span class="o">=</span><span class="mi">0</span><span class="o">.</span><span class="mi">5</span>
<span class="n">export</span> <span class="nc">GDK_DPI_SCALE</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<p>This can be done using the <code class="docutils literal notranslate"><span class="pre">nano</span></code> editor, similarly to how it
is done in  <a class="reference external" href="https://solarianprogrammer.com/2017/04/16/windows-susbsystem-for-linux-xfce-4/">this tutorial</a>.</p>
</li>
<li><p class="first">Next, close any running instance of that X server (VcxSrv). Open
the folder where you have installed it (e.g., <code class="docutils literal notranslate"><span class="pre">C:\Program</span>
<span class="pre">Files\VcXsrv</span></code>),
right click on <code class="docutils literal notranslate"><span class="pre">vcxsrv.exe</span></code>. Choose <cite>Properties &gt; Compatibility tab &gt; Change high DPI
settings &gt; Enable Override high DPI scaling</cite> and change it to
<code class="docutils literal notranslate"><span class="pre">Application</span></code> option. Here is the screenshot looks like after
changing the settings:</p>
</li>
</ul>
</li>
</ol>
<a class="reference internal image-reference" href="_images/blur.png"><img alt="_images/blur.png" class="align-center" src="_images/blur.png" style="width: 820px;" /></a>
<ol class="arabic simple" start="4">
<li>Once you have done all of this, you can run Linux terminal within the
graphical XFCE shell and execute all commands from it, rather than
from a Windows-started Ubuntu terminal. In my case, it looks
as follows:</li>
</ol>
<a class="reference internal image-reference" href="_images/xfce.png"><img alt="_images/xfce.png" class="align-center" src="_images/xfce.png" style="width: 820px;" /></a>
<ol class="arabic" start="5">
<li><p class="first">It’s time to install OCaml libraries. First, we need to install a number of
Linux packages that OCaml needs. Run the following lines from Linux terminal
(it can be done both from within graphical shell, or from within a separate
Ubuntu terminal run as a Windows applications):</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">make</span> <span class="n">m4</span> <span class="n">gcc</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span> <span class="n">libx11</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Don’t forget to enter the password you’ve created for your Linux account, it
might be different from your Windows one. Be patient: installing those
packages will take quite some time.</p>
</li>
<li><p class="first">Next, we will install the <code class="docutils literal notranslate"><span class="pre">opam</span></code> package manager for working with different OCaml libraries. Execute the following lines from Linux terminal:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">add</span><span class="o">-</span><span class="n">apt</span><span class="o">-</span><span class="n">repository</span> <span class="n">ppa</span><span class="o">:</span><span class="n">avsm</span><span class="o">/</span><span class="n">ppa</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">opam</span>
<span class="n">opam</span> <span class="n">init</span> <span class="o">-</span><span class="n">y</span> <span class="o">--</span><span class="n">compiler</span><span class="o">=</span><span class="mi">4</span><span class="o">.</span><span class="mi">10</span><span class="o">.</span><span class="mi">0</span> <span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">sandboxing</span>
<span class="n">eval</span> <span class="o">$(</span><span class="n">opam</span> <span class="n">env</span><span class="o">)</span>
<span class="n">opam</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">dune</span> <span class="n">core</span> <span class="n">batteries</span> <span class="n">utop</span> <span class="n">graphics</span> <span class="n">merlin</span> <span class="n">ocp</span><span class="o">-</span><span class="n">indent</span>
</pre></div>
</div>
<p>Once done, add the following line to your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> file:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">eval</span> <span class="o">$(</span><span class="n">opam</span> <span class="n">env</span><span class="o">)</span>
</pre></div>
</div>
<p>After that, close your terminal window and start a new one.</p>
<p>To check that your OCaml is correctly installed, run <code class="docutils literal notranslate"><span class="pre">ocamlc</span> <span class="pre">--version</span></code> from the terminal. You should get the output
<code class="docutils literal notranslate"><span class="pre">4.10.0</span></code>, which is the version of the OCaml compiler we have just installed.</p>
</li>
<li><p class="first"><strong>If you’re planning to use VSCode instead of Emacs, please, skip to the step 12.</strong></p>
<p>Now we need to install the OCaml support for Emacs. Emacs can be installed
using the instructions given <a class="reference external" href="https://solarianprogrammer.com/2017/05/18/emacs-windows-subsystem-linux/">in this article</a>.</p>
<p>To use Emacs comfortably with Windows-like shortcuts, you will need to enable the <a class="reference external" href="https://www.emacswiki.org/emacs/CuaMode">Cua mode</a> for it.
To enable Cua mode, create the file <code class="docutils literal notranslate"><span class="pre">.emacs</span></code> in you Linux home folder (i.e., it should be located under <code class="docutils literal notranslate"><span class="pre">~/.emacs</span></code>) and add the following lines to it (or just append them to the file if it already exists):</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">cua</span><span class="o">-</span><span class="n">mode</span> <span class="n">t</span><span class="o">)</span>
<span class="o">(</span><span class="n">setq</span> <span class="n">cua</span><span class="o">-</span><span class="n">auto</span><span class="o">-</span><span class="n">tabify</span><span class="o">-</span><span class="n">rectangles</span> <span class="n">nil</span><span class="o">)</span> <span class="o">;;</span> <span class="nc">Don&#39;t</span> <span class="n">tabify</span> <span class="n">after</span> <span class="n">rectangle</span> <span class="n">commands</span>
<span class="o">(</span><span class="n">transient</span><span class="o">-</span><span class="n">mark</span><span class="o">-</span><span class="n">mode</span> <span class="mi">1</span><span class="o">)</span> <span class="o">;;</span> <span class="nc">No</span> <span class="n">region</span> <span class="k">when</span> <span class="n">it</span> <span class="n">is</span> <span class="n">not</span> <span class="n">highlighted</span>
<span class="o">(</span><span class="n">setq</span> <span class="n">cua</span><span class="o">-</span><span class="n">keep</span><span class="o">-</span><span class="n">region</span><span class="o">-</span><span class="n">after</span><span class="o">-</span><span class="n">copy</span> <span class="n">t</span><span class="o">)</span> <span class="o">;;</span> <span class="nc">Standard</span> <span class="nc">Windows</span> <span class="n">behaviour</span>
</pre></div>
</div>
</li>
<li><p class="first">To continue with installing Emacs, Execute the following from terminal:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">opam</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">tuareg</span> <span class="n">user</span><span class="o">-</span><span class="n">setup</span>
<span class="n">opam</span> <span class="n">user</span><span class="o">-</span><span class="n">setup</span> <span class="n">install</span> <span class="o">--</span><span class="n">editors</span><span class="o">=</span><span class="n">emacs</span>
</pre></div>
</div>
<p>The last touch is to add the code completion feature to Emacs. Open Emacs and execute
<cite>Alt-X package-list-packages</cite>. From the list choose <cite>company -&gt; Install -&gt; Yes</cite>:</p>
</li>
</ol>
<a class="reference internal image-reference" href="_images/company.png"><img alt="_images/company.png" class="align-center" src="_images/company.png" style="width: 820px;" /></a>
<ol class="arabic" start="9">
<li><p class="first">Add the following lines to your <code class="docutils literal notranslate"><span class="pre">~/.emacs</span></code> configuration:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">;</span> <span class="nc">Make</span> <span class="n">company</span> <span class="n">aware</span> <span class="k">of</span> <span class="n">merlin</span>
<span class="o">(</span><span class="k">with</span><span class="o">-</span><span class="n">eval</span><span class="o">-</span><span class="n">after</span><span class="o">-</span><span class="n">load</span> <span class="k">&#39;</span><span class="n">company</span>
<span class="o">(</span><span class="n">add</span><span class="o">-</span><span class="k">to</span><span class="o">-</span><span class="kt">list</span> <span class="k">&#39;</span><span class="n">company</span><span class="o">-</span><span class="n">backends</span> <span class="k">&#39;</span><span class="n">merlin</span><span class="o">-</span><span class="n">company</span><span class="o">-</span><span class="n">backend</span><span class="o">))</span>
<span class="o">;</span> <span class="nc">Enable</span> <span class="n">company</span> <span class="n">on</span> <span class="n">merlin</span> <span class="n">managed</span> <span class="n">buffers</span>
<span class="o">(</span><span class="n">add</span><span class="o">-</span><span class="n">hook</span> <span class="k">&#39;</span><span class="n">merlin</span><span class="o">-</span><span class="n">mode</span><span class="o">-</span><span class="n">hook</span> <span class="k">&#39;</span><span class="n">company</span><span class="o">-</span><span class="n">mode</span><span class="o">)</span>
</pre></div>
</div>
<p>Some additional information about this Emacs mode can be found <a class="reference external" href="https://github.com/ocaml/merlin/wiki/emacs-from-scratch">here</a>.</p>
</li>
<li><p class="first">You’re good to go. To check your setup, create an OCaml file in
Emacs (e.g., <code class="docutils literal notranslate"><span class="pre">a.ml</span></code>) and try to play with some definitions. The
editor should highlight OCaml syntax, compile-time errors, and
will suggest options for name auto-completion:</p>
</li>
</ol>
<a class="reference internal image-reference" href="_images/tuareg.png"><img alt="_images/tuareg.png" class="align-center" src="_images/tuareg.png" style="width: 820px;" /></a>
<ol class="arabic" start="11">
<li><p class="first">[Optional] You can additionally setup the following parameters in Emacs for better
editing by searching in <code class="docutils literal notranslate"><span class="pre">Options</span> <span class="pre">-&gt;</span> <span class="pre">Customize</span> <span class="pre">Emacs</span> <span class="pre">-&gt;</span> <span class="pre">Top-level</span>
<span class="pre">Customization</span> <span class="pre">Group</span></code>:</p>
<ul>
<li><p class="first">Set the width of the buffer line to cut automatically beyond 80 characters
(parameter <code class="docutils literal notranslate"><span class="pre">Fill</span> <span class="pre">Column</span></code>):</p>
<a class="reference internal image-reference" href="_images/line80.png"><img alt="_images/line80.png" class="align-center" src="_images/line80.png" style="width: 820px;" /></a>
</li>
<li><p class="first">Remove the red highlighting of trailing whitespaces in the buffers
(parameter <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">Trailing</span> <span class="pre">Whitespace</span></code>):</p>
<a class="reference internal image-reference" href="_images/trailing.png"><img alt="_images/trailing.png" class="align-center" src="_images/trailing.png" style="width: 820px;" /></a>
</li>
</ul>
</li>
<li><p class="first">You can use <a class="reference external" href="https://code.visualstudio.com/">VSCode</a> instead of
Emacs for your development, assuming you’ve done steps 1-6.</p>
<p>Start by installing the Remote-WSL plugin. It is the one suggested the
firsrt time you run VSCode. Alternatively, you can install it by pressing
<code class="docutils literal notranslate"><span class="pre">Ctrl-Shift-P</span></code>, typing “install extensions”, and choosing “Install
Extensions” item from the dropdown menu, and then finding and installing the
“Remote-WSL” extension.</p>
<p>After installing that extension, press <code class="docutils literal notranslate"><span class="pre">Ctrl-Shift-P</span></code> and choose
“Remote-WSL: New Window”. This will take a few seconds and will start a new
window of VSCode that runs <strong>inside your WSL Linux</strong> (you can even start a
Linux terminal there).</p>
<p>Next, <strong>in this remote window</strong>, install the exntesion “OCaml and Reason
IDE” in the same way as described above.</p>
<p>Now, you can open an OCaml file (<code class="docutils literal notranslate"><span class="pre">Ctrl-Shift-P</span></code>, followed by “File: Open
File”) and enjoy the advanced features: highlighting, code completion, and
type information, as well as many others. An example of the UI is shown
below. Notice the indicators at the bottom of the screen, showing that
VSCode runs in WSL (Ubuntu), with OCaml/merlin support enabled:</p>
</li>
</ol>
<a class="reference internal image-reference" href="_images/vscode-wsl.png"><img alt="_images/vscode-wsl.png" class="align-center" src="_images/vscode-wsl.png" style="width: 820px;" /></a>
</div>
<div class="section" id="linux">
<h2>2.1.2. Linux<a class="headerlink" href="#linux" title="Permalink to this headline">¶</a></h2>
<p>If you’re using Linux, the setup is similar to the one for Windows 10 WSL
described previously. Just follow the points above starting from the step 5. If
you’re using a distribution different from Ubuntu, make sure to use the
corresponding package manager (instead of <code class="docutils literal notranslate"><span class="pre">apt</span></code>) to get the system packages in
the step 5.</p>
<p>If you wish to use VSCode, just follow the instructions in step 12 for Windows
10 WSL, skipping the part about Remote-WSL and remote window and starting from
installing the “OCaml and Reason IDE” extension.</p>
</div>
<div class="section" id="macos">
<h2>2.1.3. macOS<a class="headerlink" href="#macos" title="Permalink to this headline">¶</a></h2>
<p>OCaml is well supported in macOS, so the installation process is fairly straightforward.</p>
<ol class="arabic">
<li><p class="first">Install the <a class="reference external" href="https://brew.sh/">Homebrew package manager</a> for macOS.</p>
</li>
<li><p class="first">Install the following system packages using Homebrew:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">make</span> <span class="n">m4</span> <span class="n">gcc</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span>
</pre></div>
</div>
</li>
<li><p class="first">Install the <a class="reference external" href="https://www.xquartz.org/">XQuartz</a> X window system
for macOS. Make sure it <cite>before</cite> you install <code class="docutils literal notranslate"><span class="pre">opam</span></code> and all
libraries from it. We will need this library for a few graphical
applications at the end of this course.</p>
<p>Once you have done it, <strong>log-out from the system and log-in again</strong>.</p>
</li>
<li><p class="first">Next, we will install the <code class="docutils literal notranslate"><span class="pre">opam</span></code> package manager for installing
and maintaining different OCaml libraries. Execute the following
lines from the terminal:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">opam</span>
<span class="n">opam</span> <span class="n">init</span> <span class="o">-</span><span class="n">y</span> <span class="o">--</span><span class="n">compiler</span><span class="o">=</span><span class="mi">4</span><span class="o">.</span><span class="mi">10</span><span class="o">.</span><span class="mi">0</span>
<span class="n">eval</span> <span class="o">$(</span><span class="n">opam</span> <span class="n">env</span><span class="o">)</span>
<span class="n">opam</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">dune</span> <span class="n">core</span> <span class="n">batteries</span> <span class="n">utop</span> <span class="n">graphics</span> <span class="n">merlin</span> <span class="n">ocp</span><span class="o">-</span><span class="n">indent</span>
</pre></div>
</div>
<p>Once done, add the following line to your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> or <code class="docutils literal notranslate"><span class="pre">~/.profile</span></code>
files (if they exist, otherwise create <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code>):</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">eval</span> <span class="o">$(</span><span class="n">opam</span> <span class="n">env</span><span class="o">)</span>
</pre></div>
</div>
<p>After that, close your terminal window and start a new one.</p>
<p>Notice that if you had some <code class="docutils literal notranslate"><span class="pre">opam</span></code> installation before completing
step 4, the installation of the <code class="docutils literal notranslate"><span class="pre">graphics</span></code> package will fail. To
avoid it, please, run this line first before installing the listed
above packages:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">opam</span> <span class="n">switch</span> <span class="n">reinstall</span> <span class="mi">4</span><span class="o">.</span><span class="mi">10</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
<p>To check that your OCaml is correctly installed, run <code class="docutils literal notranslate"><span class="pre">ocamlc</span> <span class="pre">--version</span></code>
from the terminal. You should get the output <code class="docutils literal notranslate"><span class="pre">4.10.0</span></code>, which is the version
of the OCaml compiler we have just installed.</p>
</li>
<li><p class="first"><strong>If you’re planning to use VSCode instead of Emacs, please, skip to the step 10.</strong></p>
<p>Now we need to install the OCaml support for Emacs. As an Emacs-like editor,
I suggest to use <a class="reference external" href="http://aquamacs.org/">Aquamacs</a>. Please, download and
install it.</p>
</li>
<li><p class="first">To continue with installing Emacs, Execute the following from terminal:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">opam</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">tuareg</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">8</span> <span class="n">user</span><span class="o">-</span><span class="n">setup</span>
<span class="n">opam</span> <span class="n">user</span><span class="o">-</span><span class="n">setup</span> <span class="n">install</span> <span class="o">--</span><span class="n">editors</span><span class="o">=</span><span class="n">emacs</span>
</pre></div>
</div>
<p>It is important that you install <code class="docutils literal notranslate"><span class="pre">touareg</span></code> version 2.0.8, as other versions
might cause Emacs-related issues when compiling.
The last touch is to add the code completion feature to Aquamacs. First, add
these lines to your <code class="docutils literal notranslate"><span class="pre">~/.emacs</span></code> file (create it if it doesn’t exist):</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">;;</span> <span class="nc">Melpa</span>
<span class="o">(</span><span class="n">require</span> <span class="k">&#39;</span><span class="n">package</span><span class="o">)</span>
<span class="o">(</span><span class="n">add</span><span class="o">-</span><span class="k">to</span><span class="o">-</span><span class="kt">list</span> <span class="k">&#39;</span><span class="n">package</span><span class="o">-</span><span class="n">archives</span>
         <span class="k">&#39;</span><span class="o">(</span><span class="s2">&quot;melpa-stable&quot;</span> <span class="o">.</span> <span class="s2">&quot;https://stable.melpa.org/packages/&quot;</span><span class="o">)</span> <span class="n">t</span><span class="o">)</span>
<span class="o">(</span><span class="n">package</span><span class="o">-</span><span class="n">initialize</span><span class="o">)</span>
</pre></div>
</div>
<p>Restart Aquamacs. Once it’s reopened, execute company-mode for completion
<cite>Option-X package-list-packages</cite>. From the list choose <cite>company -&gt; Install -&gt; Yes</cite>:</p>
</li>
</ol>
<a class="reference internal image-reference" href="_images/mac-company.png"><img alt="_images/mac-company.png" class="align-center" src="_images/mac-company.png" style="width: 820px;" /></a>
<ol class="arabic" start="7">
<li><p class="first">Add the following lines to your <code class="docutils literal notranslate"><span class="pre">~/.emacs</span></code> configuration:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">;</span> <span class="nc">Make</span> <span class="n">company</span> <span class="n">aware</span> <span class="k">of</span> <span class="n">merlin</span>
<span class="o">(</span><span class="k">with</span><span class="o">-</span><span class="n">eval</span><span class="o">-</span><span class="n">after</span><span class="o">-</span><span class="n">load</span> <span class="k">&#39;</span><span class="n">company</span>
<span class="o">(</span><span class="n">add</span><span class="o">-</span><span class="k">to</span><span class="o">-</span><span class="kt">list</span> <span class="k">&#39;</span><span class="n">company</span><span class="o">-</span><span class="n">backends</span> <span class="k">&#39;</span><span class="n">merlin</span><span class="o">-</span><span class="n">company</span><span class="o">-</span><span class="n">backend</span><span class="o">))</span>
<span class="o">;</span> <span class="nc">Enable</span> <span class="n">company</span> <span class="n">on</span> <span class="n">merlin</span> <span class="n">managed</span> <span class="n">buffers</span>
<span class="o">(</span><span class="n">add</span><span class="o">-</span><span class="n">hook</span> <span class="k">&#39;</span><span class="n">merlin</span><span class="o">-</span><span class="n">mode</span><span class="o">-</span><span class="n">hook</span> <span class="k">&#39;</span><span class="n">company</span><span class="o">-</span><span class="n">mode</span><span class="o">)</span>
</pre></div>
</div>
<p>Some additional information about this Emacs mode can be found <a class="reference external" href="https://github.com/ocaml/merlin/wiki/emacs-from-scratch">here</a>.</p>
</li>
<li><p class="first">You’re good to go. To check your setup, create an OCaml file in
Emacs (e.g., <code class="docutils literal notranslate"><span class="pre">a.ml</span></code>) and try to play with some definitions. The
editor should highlight OCaml syntax, compile-time errors, and will
suggest options for name auto-completion:</p>
</li>
</ol>
<a class="reference internal image-reference" href="_images/mac-tuareg.png"><img alt="_images/mac-tuareg.png" class="align-center" src="_images/mac-tuareg.png" style="width: 820px;" /></a>
<ol class="arabic" start="9">
<li><p class="first">[Optional] You can additionally setup the following parameters in Emacs for better
editing by searching in <code class="docutils literal notranslate"><span class="pre">Options</span> <span class="pre">-&gt;</span> <span class="pre">Customize</span> <span class="pre">Aquamacs</span> <span class="pre">-&gt;</span> <span class="pre">Top-level</span>
<span class="pre">Customization</span> <span class="pre">Group</span></code>:</p>
<ul>
<li><p class="first">Set the width of the buffer line to cut automatically beyond 80 characters
(parameter <code class="docutils literal notranslate"><span class="pre">Fill</span> <span class="pre">Column</span></code>):</p>
<a class="reference internal image-reference" href="_images/line80.png"><img alt="_images/line80.png" class="align-center" src="_images/line80.png" style="width: 820px;" /></a>
</li>
<li><p class="first">Remove the red highlighting of trailing whitespaces in the buffers
(parameter <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">Trailing</span> <span class="pre">Whitespace</span></code>):</p>
<a class="reference internal image-reference" href="_images/trailing.png"><img alt="_images/trailing.png" class="align-center" src="_images/trailing.png" style="width: 820px;" /></a>
</li>
</ul>
</li>
<li><p class="first">You can use <a class="reference external" href="https://code.visualstudio.com/">VSCode</a> instead of Aquamacs,
assuming you’ve done the steps 1-4.</p>
<p>First, you you will need to install the <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=freebroccolo.reasonml">OCaml and Reason IDE extension</a>,
which enables OCaml support in VSCode (assuming you have installed all
libraries above via <code class="docutils literal notranslate"><span class="pre">opam</span></code> in the step 5). You can install the extension
by pressing <code class="docutils literal notranslate"><span class="pre">Command-Shift-P</span></code>, typing “Install Extensions”, and choosing
that item from the dropdown menu.</p>
<p>Now, if you open an OCaml file, it will look like that:</p>
</li>
</ol>
<a class="reference internal image-reference" href="_images/vscode-mac.png"><img alt="_images/vscode-mac.png" class="align-center" src="_images/vscode-mac.png" style="width: 820px;" /></a>
</div>
<div class="section" id="troubleshooting">
<h2>2.1.4. Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first"><strong>Problem</strong>: In-line tests are highlighed red in my editor with an error message
<code class="docutils literal notranslate"><span class="pre">ppx_inline_test:</span> <span class="pre">extension</span> <span class="pre">is</span> <span class="pre">disabled</span> <span class="pre">because</span> <span class="pre">the</span> <span class="pre">tests</span> <span class="pre">would</span> <span class="pre">be</span> <span class="pre">ignored</span>
<span class="pre">...</span></code>.</p>
<p><strong>Solution</strong>: This is a bug in a certain version of the tests. To fix it, install a
fixed version of the testing liberary as follows:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">opam</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">ppx_inline_test</span><span class="o">.</span><span class="n">v0</span><span class="o">.</span><span class="mi">14</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
<p>Then, in your project, run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean;</span> <span class="pre">make</span></code>. After that, the error in the
editor should be gone.</p>
</li>
<li><p class="first"><strong>Problem</strong>: Merlin is not detected by VSCode, which gives an error
“<code class="docutils literal notranslate"><span class="pre">ocamlmerlin</span></code> is not found”.</p>
<p><strong>Solution</strong>: This is the case if you didn’t add <code class="docutils literal notranslate"><span class="pre">eval</span> <span class="pre">$(opam</span> <span class="pre">env)</span></code> to the
configuration files (e.g., <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> and/or <code class="docutils literal notranslate"><span class="pre">~/.profile</span></code>). Adding it
and restarting VSCode should fix it.</p>
<p>Alternatively, you can add the following lines to the <code class="docutils literal notranslate"><span class="pre">settings.json</span></code>
file (with your account name instead of <code class="docutils literal notranslate"><span class="pre">YOURNAME</span></code>). To find that file,
press <code class="docutils literal notranslate"><span class="pre">Command-Shift-P</span></code> and choose “Preferences: Open Settings (JSON)”
(to find it just type “settings” and choose the correct option):</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;reason.path.ocamlmerlin&quot;</span><span class="o">:</span> <span class="s2">&quot;/Users/YOURNAME/.opam/4.10.0/bin/ocamlmerlin&quot;</span>
</pre></div>
</div>
<p>For example, in my case the contents of this file look as follows:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">{</span>
    <span class="s2">&quot;window.zoomLevel&quot;</span><span class="o">:</span> <span class="mi">2</span><span class="o">,</span>
    <span class="s2">&quot;search.searchOnType&quot;</span><span class="o">:</span> <span class="bp">false</span><span class="o">,</span>
    <span class="s2">&quot;reason.path.ocamlmerlin&quot;</span><span class="o">:</span> <span class="s2">&quot;/Users/ilya/.opam/4.10.0/bin/ocamlmerlin&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Don’t forget to save the file.</p>
</li>
<li><p class="first"><strong>Problem</strong>: When installing <code class="docutils literal notranslate"><span class="pre">tuareg</span></code> mode with <code class="docutils literal notranslate"><span class="pre">opam</span></code> on macOS, I get an
error:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="nc">ERROR</span><span class="o">]</span> <span class="nc">The</span> <span class="n">compilation</span> <span class="k">of</span> <span class="n">conf</span><span class="o">-</span><span class="n">emacs</span> <span class="n">failed</span> <span class="n">at</span> <span class="o">...</span>
</pre></div>
</div>
<p><strong>Solution</strong>: This can be solved by installing a particular version 2.0.8 of
<code class="docutils literal notranslate"><span class="pre">tuareg</span></code>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">opam</span> <span class="n">install</span> <span class="n">tuareg</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">8</span>
</pre></div>
</div>
<p>Another way to fix it is to ensure that the executable <code class="docutils literal notranslate"><span class="pre">emacs</span></code> is in your
<code class="docutils literal notranslate"><span class="pre">PATH</span></code>. This can be done by, e.g., installing <code class="docutils literal notranslate"><span class="pre">emacs</span></code> via Homebrew:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">emacs</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="git.html" class="btn btn-neutral float-right" title="2.2. Installing and using Git" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="prerequisites.html" class="btn btn-neutral" title="2. Software Prerequisites" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Ilya Sergey

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "jax": ["input/TeX", "output/HTML-CSS"]})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>