

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.4. Searching in Arrays &mdash; YSC2229 2019</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.5. Merge Sort" href="week-03a_merge_sort.html" />
    <link rel="prev" title="3.3. Generating Arrays" href="week-03a_array_generators.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> YSC2229: Introductory Data Structures and Algorithms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-01.html">1. YSC2229 Lecture Notes, Week 01</a></li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-02.html">2. YSC2229 Lecture Notes, Week 02</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="YSC2229-lecture-notes-week-03.html">3. YSC2229 Lecture Notes, Week 03</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="week-03b_recursive_complexity.html">3.1. Complexity of Simple Recursive Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-03b_exercises.html">3.2. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-03a_array_generators.html">3.3. Generating Arrays</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.4. Searching in Arrays</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#linear-search">3.4.1. Linear Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-5">3.4.2. Exercise 5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#binary-search">3.4.3. Binary Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-6">3.4.4. Exercise 6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#binary-search-invariant">3.4.5. Binary Search Invariant</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-7">3.4.6. Exercise 7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-main-idea-of-divide-and-conquer-algorithms">3.4.7. The Main Idea of Divide-and-Conquer algorithms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="week-03a_merge_sort.html">3.5. Merge Sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="week-03a_exercises.html">3.6. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-04.html">4. YSC2229 Lecture Notes, Week 04</a></li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-05.html">5. YSC2229 Lecture Notes, Week 05</a></li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-06.html">6. YSC2229 Lecture Notes, Week 06</a></li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-midterm-tasks.html">7. YSC2229: Midterm Project, Week 07</a></li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-08.html">8. YSC2229 Lecture Notes, Week 08</a></li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-09.html">9. YSC2229 Lecture Notes, Week 09</a></li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-10.html">10. YSC2229 Lecture Notes, Week 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="YSC2229-lecture-notes-week-11.html">11. YSC2229 Lecture Notes, Week 11</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">YSC2229: Introductory Data Structures and Algorithms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="YSC2229-lecture-notes-week-03.html">3. YSC2229 Lecture Notes, Week 03</a> &raquo;</li>
        
      <li>3.4. Searching in Arrays</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="searching-in-arrays">
<h1>3.4. Searching in Arrays<a class="headerlink" href="#searching-in-arrays" title="Permalink to this headline">¶</a></h1>
<p>Let us put key-value arrays to some good use.</p>
<div class="section" id="linear-search">
<h2>3.4.1. Linear Search<a class="headerlink" href="#linear-search" title="Permalink to this headline">¶</a></h2>
<p>One of the most common operations with key-value arrays is <em>searching</em> looking for the index of an element with some known key, or reporting that there is not such element. The simples implementation of searching walks through the entire array until the sought element is found, or the whole array is traversed:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">linear_search</span> <span class="n">arr</span> <span class="n">k</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">len</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">arr</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">res</span> <span class="o">=</span> <span class="n">ref</span> <span class="nc">None</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span> <span class="k">in</span>
  <span class="k">while</span> <span class="o">!</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">res</span> <span class="o">=</span> <span class="nc">None</span> <span class="k">do</span>
    <span class="o">(</span><span class="k">if</span> <span class="n">fst</span> <span class="n">arr</span><span class="o">.(!</span><span class="n">i</span><span class="o">)</span> <span class="o">=</span> <span class="n">k</span>
    <span class="k">then</span> <span class="n">res</span> <span class="o">:=</span> <span class="nc">Some</span> <span class="o">((!</span><span class="n">i</span><span class="o">,</span> <span class="n">arr</span><span class="o">.(!</span><span class="n">i</span><span class="o">))));</span>
    <span class="n">i</span> <span class="o">:=</span> <span class="o">!</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="k">done</span><span class="o">;</span>
  <span class="o">!</span><span class="n">res</span>
</pre></div>
</div>
<p>We can now test it on a random array:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="o">[|(</span><span class="mi">9</span><span class="o">,</span> <span class="s2">&quot;lgora&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s2">&quot;hvrxd&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s2">&quot;zeuvd&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s2">&quot;powdp&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="s2">&quot;sitgt&quot;</span><span class="o">);</span>
        <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="s2">&quot;khfnv&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s2">&quot;omjkn&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s2">&quot;txwyw&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s2">&quot;wqwpu&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s2">&quot;hwhju&quot;</span><span class="o">)|];;</span>

<span class="o">#</span> <span class="n">linear_search</span> <span class="n">a</span> <span class="mi">4</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="o">(</span><span class="kt">int</span> <span class="o">*</span> <span class="o">(</span><span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span><span class="o">))</span> <span class="n">option</span> <span class="o">=</span> <span class="nc">Some</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="s2">&quot;khfnv&quot;</span><span class="o">))</span>
<span class="o">#</span> <span class="n">linear_search</span> <span class="n">a</span> <span class="mi">10</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="o">(</span><span class="kt">int</span> <span class="o">*</span> <span class="o">(</span><span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span><span class="o">))</span> <span class="n">option</span> <span class="o">=</span> <span class="nc">None</span>
</pre></div>
</div>
<p>In the first case, <code class="docutils literal notranslate"><span class="pre">linear_search</span></code> has returned the index (<code class="docutils literal notranslate"><span class="pre">5</span></code>) of an element with the key 4, as well as the element itself. In the second case, it returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, as there is no key <code class="docutils literal notranslate"><span class="pre">10</span></code> in the array <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
</div>
<div class="section" id="exercise-5">
<span id="exercise-find-range-unsorted"></span><h2>3.4.2. Exercise 5<a class="headerlink" href="#exercise-5" title="Permalink to this headline">¶</a></h2>
<p>Find a procedure that takes an unsorted array and a given range of keys (represented by a pair of numbers <code class="docutils literal notranslate"><span class="pre">lo</span> <span class="pre">&lt;</span> <span class="pre">hi</span></code>, right boundary not included), and returns the list of all elements in the array, whose keys are in that range. Estimate the complexity of this procedure.</p>
</div>
<div class="section" id="binary-search">
<h2>3.4.3. Binary Search<a class="headerlink" href="#binary-search" title="Permalink to this headline">¶</a></h2>
<p>Binary search is an efficient search procedure that works on a <em>sorted array</em> and looks for an element in it, repeatedly dividing its search-space by half:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">binary_search</span> <span class="n">arr</span> <span class="n">k</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">rank</span> <span class="n">lo</span> <span class="n">hi</span> <span class="o">=</span>
    <span class="k">if</span> <span class="n">hi</span> <span class="o">&lt;=</span> <span class="n">lo</span>
    <span class="k">then</span>
      <span class="c">(* Empty array *)</span>
      <span class="nc">None</span>
    <span class="c">(* Converged on a single element *)</span>
    <span class="k">else</span>
      <span class="k">let</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">lo</span> <span class="o">+</span> <span class="o">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">in</span>
      <span class="k">if</span> <span class="n">fst</span> <span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">)</span> <span class="o">=</span> <span class="n">k</span>
      <span class="k">then</span> <span class="nc">Some</span> <span class="o">(</span><span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">))</span>
      <span class="k">else</span> <span class="k">if</span> <span class="n">fst</span> <span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">)</span> <span class="o">&lt;</span> <span class="n">k</span>
      <span class="k">then</span> <span class="n">rank</span> <span class="o">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="n">hi</span>
      <span class="k">else</span> <span class="n">rank</span> <span class="n">lo</span> <span class="n">mid</span>
  <span class="k">in</span>
  <span class="n">rank</span> <span class="mi">0</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">arr</span><span class="o">)</span>
</pre></div>
</div>
<p>The auxiliary procedure <code class="docutils literal notranslate"><span class="pre">rank</span></code> keeps changing the search boundary by recomputing the median of the search range and comparing the element in it. This way it makes sure that the element is already found, or the search space contains it iff and only iff the original array contains it. Let us trace the  binary search and figure out its invariant:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">binary_search_print</span> <span class="n">arr</span> <span class="n">k</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">rank</span> <span class="n">lo</span> <span class="n">hi</span> <span class="o">=</span>
    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;Subarray: [&quot;</span><span class="o">;</span>
    <span class="k">let</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">array_to_list</span> <span class="n">lo</span> <span class="n">hi</span> <span class="n">arr</span> <span class="k">in</span>
    <span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">k</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;(%d, %s); &quot;</span> <span class="n">k</span> <span class="n">v</span><span class="o">)</span> <span class="n">ls</span><span class="o">;</span>
    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;]</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">;</span>
    <span class="k">if</span> <span class="n">hi</span> <span class="o">&lt;=</span> <span class="n">lo</span>
    <span class="k">then</span>
      <span class="c">(* Empty array *)</span>
      <span class="nc">None</span>
    <span class="c">(* Converged on a single element *)</span>
    <span class="k">else</span>
      <span class="k">let</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">lo</span> <span class="o">+</span> <span class="o">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">in</span>
      <span class="k">if</span> <span class="n">fst</span> <span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">)</span> <span class="o">=</span> <span class="n">k</span>
      <span class="k">then</span> <span class="nc">Some</span> <span class="o">(</span><span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">))</span>
      <span class="k">else</span> <span class="k">if</span> <span class="n">fst</span> <span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">)</span> <span class="o">&lt;</span> <span class="n">k</span>
      <span class="k">then</span> <span class="n">rank</span> <span class="o">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="n">hi</span>
      <span class="k">else</span> <span class="n">rank</span> <span class="n">lo</span> <span class="n">mid</span>
  <span class="k">in</span>
  <span class="n">rank</span> <span class="mi">0</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">arr</span><span class="o">)</span>

<span class="k">let</span> <span class="n">a1</span> <span class="o">=</span> <span class="o">[|(</span><span class="mi">0</span><span class="o">,</span> <span class="s2">&quot;vzxtx&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;hjqxi&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="s2">&quot;wzgsx&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="s2">&quot;hkuiu&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="s2">&quot;bvyjr&quot;</span><span class="o">);</span>
  <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="s2">&quot;hdgrv&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="s2">&quot;sobff&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="s2">&quot;bpelh&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="s2">&quot;xonjr&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="s2">&quot;qjzui&quot;</span><span class="o">);</span>
  <span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="s2">&quot;syhze&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="s2">&quot;xyzxu&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="s2">&quot;gaixr&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="s2">&quot;obght&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">11</span><span class="o">,</span> <span class="s2">&quot;wmiwb&quot;</span><span class="o">);</span>
  <span class="o">(</span><span class="mi">11</span><span class="o">,</span> <span class="s2">&quot;dzvmf&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">12</span><span class="o">,</span> <span class="s2">&quot;teaum&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">13</span><span class="o">,</span> <span class="s2">&quot;gazaf&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="s2">&quot;svemi&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">15</span><span class="o">,</span> <span class="s2">&quot;rxpus&quot;</span><span class="o">);</span>
  <span class="o">(</span><span class="mi">15</span><span class="o">,</span> <span class="s2">&quot;agajq&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="s2">&quot;vztoj&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="s2">&quot;oszgf&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="s2">&quot;ylxiy&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">23</span><span class="o">,</span> <span class="s2">&quot;itosu&quot;</span><span class="o">);</span>
  <span class="o">(</span><span class="mi">26</span><span class="o">,</span> <span class="s2">&quot;nondm&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">27</span><span class="o">,</span> <span class="s2">&quot;yazoj&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">28</span><span class="o">,</span> <span class="s2">&quot;nqzcl&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">29</span><span class="o">,</span> <span class="s2">&quot;lfevj&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="s2">&quot;hfcds&quot;</span><span class="o">);</span>
  <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="s2">&quot;pgrym&quot;</span><span class="o">);</span> <span class="o">(</span><span class="mi">32</span><span class="o">,</span> <span class="s2">&quot;yghgg&quot;</span><span class="o">)|];;</span>

<span class="n">new_insert_sort</span> <span class="n">a1</span><span class="o">;;</span>
</pre></div>
</div>
<p>Now, as <code class="docutils literal notranslate"><span class="pre">a1</span></code> is sorted, we can run the binary search on it:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">binary_search_print</span> <span class="n">a1</span> <span class="mi">32</span><span class="o">;;</span>
<span class="nc">Subarray</span><span class="o">:</span> <span class="o">[(</span><span class="mi">0</span><span class="o">,</span> <span class="n">vzxtx</span><span class="o">);</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">hjqxi</span><span class="o">);</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">wzgsx</span><span class="o">);</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">hkuiu</span><span class="o">);</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">bvyjr</span><span class="o">);</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">hdgrv</span><span class="o">);</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">sobff</span><span class="o">);</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">bpelh</span><span class="o">);</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">xonjr</span><span class="o">);</span> <span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="n">qjzui</span><span class="o">);</span> <span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="n">syhze</span><span class="o">);</span> <span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="n">xyzxu</span><span class="o">);</span> <span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="n">gaixr</span><span class="o">);</span> <span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">obght</span><span class="o">);</span> <span class="o">(</span><span class="mi">11</span><span class="o">,</span> <span class="n">wmiwb</span><span class="o">);</span> <span class="o">(</span><span class="mi">11</span><span class="o">,</span> <span class="n">dzvmf</span><span class="o">);</span> <span class="o">(</span><span class="mi">12</span><span class="o">,</span> <span class="n">teaum</span><span class="o">);</span> <span class="o">(</span><span class="mi">13</span><span class="o">,</span> <span class="n">gazaf</span><span class="o">);</span> <span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="n">svemi</span><span class="o">);</span> <span class="o">(</span><span class="mi">15</span><span class="o">,</span> <span class="n">rxpus</span><span class="o">);</span> <span class="o">(</span><span class="mi">15</span><span class="o">,</span> <span class="n">agajq</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="n">vztoj</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="n">oszgf</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="n">ylxiy</span><span class="o">);</span> <span class="o">(</span><span class="mi">23</span><span class="o">,</span> <span class="n">itosu</span><span class="o">);</span> <span class="o">(</span><span class="mi">26</span><span class="o">,</span> <span class="n">nondm</span><span class="o">);</span> <span class="o">(</span><span class="mi">27</span><span class="o">,</span> <span class="n">yazoj</span><span class="o">);</span> <span class="o">(</span><span class="mi">28</span><span class="o">,</span> <span class="n">nqzcl</span><span class="o">);</span> <span class="o">(</span><span class="mi">29</span><span class="o">,</span> <span class="n">lfevj</span><span class="o">);</span> <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="n">hfcds</span><span class="o">);</span> <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="n">pgrym</span><span class="o">);</span> <span class="o">(</span><span class="mi">32</span><span class="o">,</span> <span class="n">yghgg</span><span class="o">);</span> <span class="o">]</span>

<span class="nc">Subarray</span><span class="o">:</span> <span class="o">[(</span><span class="mi">13</span><span class="o">,</span> <span class="n">gazaf</span><span class="o">);</span> <span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="n">svemi</span><span class="o">);</span> <span class="o">(</span><span class="mi">15</span><span class="o">,</span> <span class="n">rxpus</span><span class="o">);</span> <span class="o">(</span><span class="mi">15</span><span class="o">,</span> <span class="n">agajq</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="n">vztoj</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="n">oszgf</span><span class="o">);</span> <span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="n">ylxiy</span><span class="o">);</span> <span class="o">(</span><span class="mi">23</span><span class="o">,</span> <span class="n">itosu</span><span class="o">);</span> <span class="o">(</span><span class="mi">26</span><span class="o">,</span> <span class="n">nondm</span><span class="o">);</span> <span class="o">(</span><span class="mi">27</span><span class="o">,</span> <span class="n">yazoj</span><span class="o">);</span> <span class="o">(</span><span class="mi">28</span><span class="o">,</span> <span class="n">nqzcl</span><span class="o">);</span> <span class="o">(</span><span class="mi">29</span><span class="o">,</span> <span class="n">lfevj</span><span class="o">);</span> <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="n">hfcds</span><span class="o">);</span> <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="n">pgrym</span><span class="o">);</span> <span class="o">(</span><span class="mi">32</span><span class="o">,</span> <span class="n">yghgg</span><span class="o">);</span> <span class="o">]</span>

<span class="nc">Subarray</span><span class="o">:</span> <span class="o">[(</span><span class="mi">26</span><span class="o">,</span> <span class="n">nondm</span><span class="o">);</span> <span class="o">(</span><span class="mi">27</span><span class="o">,</span> <span class="n">yazoj</span><span class="o">);</span> <span class="o">(</span><span class="mi">28</span><span class="o">,</span> <span class="n">nqzcl</span><span class="o">);</span> <span class="o">(</span><span class="mi">29</span><span class="o">,</span> <span class="n">lfevj</span><span class="o">);</span> <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="n">hfcds</span><span class="o">);</span> <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="n">pgrym</span><span class="o">);</span> <span class="o">(</span><span class="mi">32</span><span class="o">,</span> <span class="n">yghgg</span><span class="o">);</span> <span class="o">]</span>

<span class="nc">Subarray</span><span class="o">:</span> <span class="o">[(</span><span class="mi">31</span><span class="o">,</span> <span class="n">hfcds</span><span class="o">);</span> <span class="o">(</span><span class="mi">31</span><span class="o">,</span> <span class="n">pgrym</span><span class="o">);</span> <span class="o">(</span><span class="mi">32</span><span class="o">,</span> <span class="n">yghgg</span><span class="o">);</span> <span class="o">]</span>

<span class="nc">Subarray</span><span class="o">:</span> <span class="o">[(</span><span class="mi">32</span><span class="o">,</span> <span class="n">yghgg</span><span class="o">);</span> <span class="o">]</span>

<span class="o">-</span> <span class="o">:</span> <span class="o">(</span><span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span><span class="o">)</span> <span class="n">option</span> <span class="o">=</span> <span class="nc">Some</span> <span class="o">(</span><span class="mi">32</span><span class="o">,</span> <span class="s2">&quot;yghgg&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Notice that at each iteration the sub-array halves, so <code class="docutils literal notranslate"><span class="pre">binary_sort</span></code> does not even have consider the entire array!</p>
</div>
<div class="section" id="exercise-6">
<span id="exercise-binare-no-mid"></span><h2>3.4.4. Exercise 6<a class="headerlink" href="#exercise-6" title="Permalink to this headline">¶</a></h2>
<p>Modify <code class="docutils literal notranslate"><span class="pre">binary_search</span></code> in a way that it does not test the equality of <code class="docutils literal notranslate"><span class="pre">fst</span> <span class="pre">arr.(mid)</span> <span class="pre">=</span> <span class="pre">k</span></code> and does not exclude the middle element, but rather considers it as a part of one of the recursively processed array subparts.</p>
</div>
<div class="section" id="binary-search-invariant">
<h2>3.4.5. Binary Search Invariant<a class="headerlink" href="#binary-search-invariant" title="Permalink to this headline">¶</a></h2>
<p>Binary search crucially relies on the fact that the given array (and hence its contiguous sub-arrays) are sorted, so, upon comparing the key to the middle, it can safely ignore the half that is irrelevant for it. This can be captured by the following precondition we are going to give to <code class="docutils literal notranslate"><span class="pre">rank</span></code>. It postulates that a sought element with a key <code class="docutils literal notranslate"><span class="pre">k</span></code> is in the whole arrays if and only if it is in the sub array, bound by <code class="docutils literal notranslate"><span class="pre">lo</span> <span class="pre">..</span> <span class="pre">hi</span></code> that we are about to consider:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">binary_search_rank_pre</span> <span class="n">arr</span> <span class="n">lo</span> <span class="n">hi</span> <span class="n">k</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">len</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">arr</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">array_to_list</span> <span class="mi">0</span> <span class="n">len</span> <span class="n">arr</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">ls&#39;</span> <span class="o">=</span> <span class="n">array_to_list</span> <span class="n">lo</span> <span class="n">hi</span> <span class="n">arr</span> <span class="k">in</span>
  <span class="k">if</span> <span class="nn">List</span><span class="p">.</span><span class="n">exists</span> <span class="o">(</span><span class="k">fun</span> <span class="n">e</span> <span class="o">-&gt;</span> <span class="n">fst</span> <span class="n">e</span> <span class="o">=</span> <span class="n">k</span><span class="o">)</span> <span class="n">ls</span>
  <span class="k">then</span> <span class="nn">List</span><span class="p">.</span><span class="n">exists</span> <span class="o">(</span><span class="k">fun</span> <span class="n">e</span> <span class="o">-&gt;</span> <span class="n">fst</span> <span class="n">e</span> <span class="o">=</span> <span class="n">k</span><span class="o">)</span> <span class="n">ls&#39;</span>
  <span class="k">else</span> <span class="n">not</span> <span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">exists</span> <span class="o">(</span><span class="k">fun</span> <span class="n">e</span> <span class="o">-&gt;</span> <span class="n">fst</span> <span class="n">e</span> <span class="o">=</span> <span class="n">k</span><span class="o">)</span> <span class="n">ls&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>We can also annotate our implementation with this invariant and test it:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">binary_search_inv</span> <span class="n">arr</span> <span class="n">k</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">rank</span> <span class="n">lo</span> <span class="n">hi</span> <span class="o">=</span>
    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;lo = %d, hi = %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">lo</span> <span class="n">hi</span><span class="o">;</span>
    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;Subarray: [&quot;</span><span class="o">;</span>
    <span class="k">let</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">array_to_list</span> <span class="n">lo</span> <span class="n">hi</span> <span class="n">arr</span> <span class="k">in</span>
    <span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">k</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;(%d, %s); &quot;</span> <span class="n">k</span> <span class="n">v</span><span class="o">)</span> <span class="n">ls</span><span class="o">;</span>
    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;</span>
    <span class="k">if</span> <span class="n">hi</span> <span class="o">&lt;=</span> <span class="n">lo</span>
    <span class="k">then</span>
      <span class="c">(* Empty array *)</span>
      <span class="nc">None</span>
    <span class="c">(* Converged on a single element *)</span>
    <span class="k">else</span>
      <span class="k">let</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">lo</span> <span class="o">+</span> <span class="o">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">in</span>
      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;mid = %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">mid</span><span class="o">;</span>
      <span class="k">if</span> <span class="n">fst</span> <span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">)</span> <span class="o">=</span> <span class="n">k</span>
      <span class="k">then</span> <span class="nc">Some</span> <span class="o">(</span><span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">))</span>
      <span class="k">else</span> <span class="k">if</span> <span class="n">fst</span> <span class="n">arr</span><span class="o">.(</span><span class="n">mid</span><span class="o">)</span> <span class="o">&lt;</span> <span class="n">k</span>
      <span class="k">then</span>
        <span class="o">(</span><span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;THEN: lo = %d, hi = %d</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="n">hi</span><span class="o">;</span>
        <span class="k">assert</span> <span class="o">(</span><span class="n">binary_search_rank_pre</span> <span class="n">arr</span> <span class="o">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="n">hi</span> <span class="n">k</span><span class="o">);</span>
        <span class="n">rank</span> <span class="o">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="n">hi</span><span class="o">)</span>
      <span class="k">else</span>
        <span class="o">(</span><span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;ELSE: lo = %d, hi = %d</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="n">lo</span> <span class="n">mid</span><span class="o">;</span>
        <span class="k">assert</span> <span class="o">(</span><span class="n">binary_search_rank_pre</span> <span class="n">arr</span> <span class="n">lo</span> <span class="n">mid</span> <span class="n">k</span><span class="o">);</span>
         <span class="n">rank</span> <span class="n">lo</span> <span class="n">mid</span><span class="o">)</span>
  <span class="k">in</span>
  <span class="k">let</span> <span class="n">len</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">arr</span> <span class="k">in</span>
  <span class="k">assert</span> <span class="o">(</span><span class="n">binary_search_rank_pre</span> <span class="n">arr</span> <span class="mi">0</span> <span class="n">len</span> <span class="n">k</span><span class="o">);</span>
  <span class="n">rank</span> <span class="mi">0</span> <span class="n">len</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-7">
<span id="exercise-exponential-search"></span><h2>3.4.6. Exercise 7<a class="headerlink" href="#exercise-7" title="Permalink to this headline">¶</a></h2>
<p>Exponential search is a more efficient version of binary-search, which can also work on infinite sorted arrays (e.g., never-ending streams of given key-value pairs). It starts by choosing the initial search range by making it to be an increasing power of two. Once a suitable range is determined, it works similarly to binary search on that range.  Implement exponential search and argue for its correcntess. [Optionally] Annotate it with preconditions.</p>
</div>
<div class="section" id="the-main-idea-of-divide-and-conquer-algorithms">
<h2>3.4.7. The Main Idea of Divide-and-Conquer algorithms<a class="headerlink" href="#the-main-idea-of-divide-and-conquer-algorithms" title="Permalink to this headline">¶</a></h2>
<p>Both Binary and Exponential search algorithms are examples of the so-called <em>divide-and-conquer</em> approach. In this approach the processing of a data (a key-value array in our case) is based on multi-branched recursion. A divide-and-conquer algorithm works by recursively breaking down a problem into two or more sub-problems of the same or related type, until these become simple enough to be solved directly (such as reporting an element). The solutions to the sub-problems are then combined to give a solution to the original problem.</p>
<p><strong>Checkpoint question:</strong> What is the “divide” and what is a “conquer” phase of the binary search?</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="week-03a_merge_sort.html" class="btn btn-neutral float-right" title="3.5. Merge Sort" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="week-03a_array_generators.html" class="btn btn-neutral" title="3.3. Generating Arrays" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Ilya Sergey

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "jax": ["input/TeX", "output/HTML-CSS"]})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>